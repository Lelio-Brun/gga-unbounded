map G1 * G2 -> GT.

sample V,W.

input [V,W] in G1.

oracle o1(M:G2) =
  sample R;
  return [ R ] in G1,
         [ R^-1, (M*V + W)*R^-1] in G2.

win (wM:G2, wR:G1, wT:G2, wS:G2) = (forall i: wM <> M_i /\ wR*wT = 1 /\ wR*wS = V*wM + W).

proof.

extract (;) 3.
extract (; W) 3.
extract (i; R_i) 3.
extract (i; R_i^-1) 3.
extract (i; R_i^-1*W) 3.
extract (i; R_i^-1*W^2) 3.
extract (i,j; R_i*R_j^-1) 3.
extract (i,j; R_i*R_j^-1*W) 3.
extract (;) 2.
extract (; W) 2.
extract (i; R_i^-1*W) 2.
extract (i; R_i^-1*W^2) 2.
extract (i; R_i^-1) 2.
extract (i; R_i) 2.
extract (i,j; R_i*R_j^-1*W) 2.
extract (i,j; R_i*R_j^-1) 2.
simplify_vars.
case_distinction p7_i.
  simplify.
  contradiction.
simplify.



