map G1 * G2 -> GT.

sample V,W.

input [V,W] in G1.

oracle o1(M:G2) =
  sample R;
  return [ R ] in G1,
         [ R, M*V + R^2 + W] in G2.

win (wM:G2, wR1:G1, wR2:G2, wS:G2) = (forall i: wM <> M_i /\ wR1 = wR2 /\ wS = V*wM + wR1*wR2 + W).

proof.

extract (;) 3.
extract (; W) 3.
extract (i; R_i) 3.
extract (i; R_i^2) 3.
extract (i; R_i^3) 3.
extract (i,j; R_i*R_j) 3.
extract (i,j; R_i*R_j^2) 3.
extract (; W^2) 3.
extract (i; R_i*W) 3.
extract (i; R_i^2*W) 3.
extract (;) 2.
extract (; W) 2.
extract (i; R_i^2) 2.
extract (i; R_i) 2.
simplify_vars.
simplify.
simplify.
case_distinction p13_i.
  contradiction.
  simplify.
contradiction.


